(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{63:function(e,t,n){e.exports=n(95)},68:function(e,t,n){},73:function(e,t,n){},74:function(e,t,n){},77:function(e,t,n){},78:function(e,t,n){},95:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),r=n(53),c=n.n(r),i=(n(68),n(9)),l=n(60),u=n(22),s=n(14),d=n.n(s),m=n(23),p=n(12),E=n(24),v=(n(73),n(74),n(31)),f=n(19),b=(n(77),Object(a.createContext)({pinIcon:2,color:1,pins:null,draftPin:null,currentPin:null,liveLocation:null,liveLocations:null})),y=[f.c,f.k,f.i,f.j,f.b,f.a,f.f],g=["Black","Blue","BlueViolet","Brown","CadetBlue","Chartreuse","Chocolate","Coral","CornflowerBlue","Crimson","DarkBlue","DarkCyan","DarkGoldenRod","DarkGreen","DarkMagenta","DarkOliveGreen","DarkOrange","DarkOrchid","DarkRed","DarkSalmon","DarkSlateBlue","DarkSlateGray","DarkSlateGrey","DarkViolet","DeepPink","DimGray","DimGrey","DodgerBlue","FireBrick","ForestGreen","Fuchsia","GoldenRod","Gray","Grey","Green","HotPink","IndianRed","Indigo","LawnGreen","LightCoral","LightSalmon","LightSeaGreen","LightSlateGray","LightSlateGrey","Lime","LimeGreen","Magenta","Maroon","MediumAquaMarine","MediumBlue","MediumOrchid","MediumPurple","MediumSeaGreen","MediumSlateBlue","MediumVioletRed","MidnightBlue","Navy","Olive","OliveDrab","Orange","OrangeRed","Orchid","PaleVioletRed","Peru","Plum","Purple","RebeccaPurple","Red","RosyBrown","RoyalBlue","SaddleBrown","Salmon","SeaGreen","Sienna"],L=function(e){var t=e.icon,n=e.color,r=Object(a.useContext)(b).state;return console.log(y[r.pinIcon]),o.a.createElement("div",{className:"pinMarker"},o.a.createElement("div",{className:"icon",style:{color:g[n]}},o.a.createElement(v.a,{icon:y[t]})))},O=function(e){return o.a.createElement("div",{className:"pinMarker"},o.a.createElement("div",{className:"icon",style:{color:g[4],fontSize:"1.5em"}},o.a.createElement(v.a,{icon:f.h})))},h=function(){return o.a.createElement(v.a,{icon:f.g})},N=function(){return o.a.createElement(v.a,{icon:f.d})},_=function(){return o.a.createElement(v.a,{icon:f.e})};n(78);var C=function(e){var t=e.children;return o.a.createElement("div",{className:"modal"},t)},D=new(n(55).GraphQLClient)("https://radiant-lake-34932.herokuapp.com/graphql"),j="\nquery {\n    getPins{\n        _id\n        name\n        category\n        color\n        location {\n            type\n            coordinates\n        }\n    }\n}\n",k="\nquery {\n    getLiveLocations{\n        _id\n        name\n        category\n        location {\n            type\n            coordinates\n        }\n    }\n}\n",S="\nmutation($name:String,$lng:Float,$lat:Float,$color:Int,$category:Int,$type:String) {\n    createPin(data:{\n        name:$name,\n        color:$color,\n        category:$category,\n        location:{\n            type:$type,\n            coordinates:[$lng,$lat]\n        }\n    }) {\n        _id\n        name\n        color\n        category\n        location{\n            type\n            coordinates\n        }\n    }\n}\n",w="\nmutation($name:String,$category:Int,$lat:Float,$lng:Float,$type:String) {\n    addLiveLocation(data:{\n        name:$name,\n        category:$category,\n        location:{\n            type:$type,\n            coordinates:[$lng,$lat]\n        }\n    }){\n        _id\n        name\n        category\n        location{\n            type\n            coordinates\n        }\n    }\n}\n",A="\nmutation($id:ID,$lng:Float,$lat:Float){\n    updateLiveLocation(id:$id,lng:$lng,lat:$lat){\n        _id\n        name\n        category\n        location{\n            type\n            coordinates\n        } \n    }\n}\n",I="\nmutation($id:ID){\n    deleteLiveLocation(id:$id){\n        _id\n    }\n}\n",T=n(35),P=n(36),R=n.n(P);function $(){var e=Object(T.a)(["\nsubscription {\nliveLocationDeleted {\n    _id\n}\n}\n"]);return $=function(){return e},e}function x(){var e=Object(T.a)(["\nsubscription {\nliveLocationUpdated {\n    _id\n        name\n        category\n        location{\n            type\n            coordinates\n        }\n}\n}\n"]);return x=function(){return e},e}function G(){var e=Object(T.a)(["\nsubscription {\nliveLocationAdded {\n    _id\n        name\n        category\n        location{\n            type\n            coordinates\n        }\n}\n}\n"]);return G=function(){return e},e}function M(){var e=Object(T.a)(["\nsubscription {\npinAdded {\n    _id\n        name\n        color\n        category\n        location{\n            type\n            coordinates\n        }\n}\n}\n"]);return M=function(){return e},e}var B=R()(M()),V=R()(G()),F=R()(x()),q=R()($()),W=n(25);var U=function(e){var t=e.modalOpen,n=e.liveLocationModal,r=Object(a.useContext)(b),c=r.state,l=r.dispatch,u=Object(a.useState)({latitude:26.5363,longitude:88.0803,zoom:13}),s=Object(i.a)(u,2),v=s[0],f=s[1],y=function(){var e=Object(m.a)(d.a.mark(function e(){var t,n;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D.request(j);case 2:t=e.sent,n=t.getPins,l({type:"ALL_PINS",payload:n});case 5:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),g=function(){var e=Object(m.a)(d.a.mark(function e(){var t,n;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D.request(k);case 2:t=e.sent,n=t.getLiveLocations,l({type:"LIVE_LOCATIONS",payload:n});case 5:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}();Object(a.useEffect)(function(){y()},[]),Object(a.useEffect)(function(){g()},[]);var S={enableHighAccuracy:!0,timeout:5e3,maximumAge:0},w=Object(a.useState)(null),A=Object(i.a)(w,2),T=A[0],P=A[1],R=Object(a.useState)(!1),$=Object(i.a)(R,2),x=$[0],G=$[1],M=Object(a.useState)(null),U=Object(i.a)(M,2),J=U[0],H=U[1];Object(a.useEffect)(function(){Y(),z()},[]);var z=function(){"geolocation"in navigator&&navigator.geolocation.getCurrentPosition(function(e){var t=e.coords,n=t.latitude,a=t.longitude;f(Object(p.a)({},v,{latitude:n,longitude:a})),H({latitude:n,longitude:a})},function(e){1===e.code&&G(!0)},S)};console.log(T);var K=function(e){console.log("here"),l({type:"DELETE_DRAFT"}),P(e)},Y=function(){if("geolocation"in navigator){var e=navigator.geolocation.getCurrentPosition(function(e){var t=e.coords,n=t.latitude,a=t.longitude;f(Object(p.a)({},v,{latitude:n,longitude:a}))},function(e){1===e.code&&G(!0)},S);navigator.geolocation.clearWatch(e)}},Z=function(){var e=Object(m.a)(d.a.mark(function e(){var t,n;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return Y(),t=c.liveLocation._id,n={id:t},e.next=5,D.request(I,n);case 5:e.sent.deleteLiveLocation,P(null);case 8:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}();return x?o.a.createElement(C,null,o.a.createElement("div",{className:"modal-content"},o.a.createElement("div",{className:"contents"},o.a.createElement("p",{className:"title"},"Sorry! We're unable to track your Location."),o.a.createElement("p",{className:"desc"},"Note: Everybody will be able to see your shared location!")),o.a.createElement("div",{className:"btn-group"},o.a.createElement("button",{onClick:function(){return G(!1)}},"Cancel")))):o.a.createElement("div",{className:"map"},o.a.createElement(E.d,Object.assign({},v,{onClick:function(e){return function(e){P(null);var t=Object(i.a)(e.lngLat,2),n=t[0],a=t[1];l({type:"CREATE_DRAFT",payload:{lng:n,lat:a}})}(e)},onViewportChange:function(e){return f(e)},width:"100vw",height:"100vh",mapStyle:"mapbox://styles/mapbox/streets-v9",mapboxApiAccessToken:"pk.eyJ1IjoibWl0aGxleGgiLCJhIjoiY2p4aWxxajZxMG5hYTNubnY2OWZ0MGljaiJ9.kdK80LecD6yKdEK0ASom6w"}),o.a.createElement("div",{className:"navigation"},o.a.createElement(E.b,{onViewportChange:function(e){return f(e)}})),J&&!c.liveLocation&&o.a.createElement(E.a,{latitude:J.latitude,longitude:J.longitude},o.a.createElement(L,{icon:1,color:c.color})),c.draftPin&&o.a.createElement(E.a,{latitude:c.draftPin.lat,longitude:c.draftPin.lng,offsetTop:-20,offsetLeft:-10},o.a.createElement(O,{color:5})),c.pins&&c.pins.map(function(e){return o.a.createElement("div",{key:e._id,onClick:function(){return K(e)}},o.a.createElement(E.a,{latitude:e.location.coordinates[1],longitude:e.location.coordinates[0]},o.a.createElement(L,{icon:e.category,color:e.color})))}),c.liveLocations&&c.liveLocations.map(function(e){return o.a.createElement("div",{className:"live-location",key:e._id,onClick:function(){return K(e)}},o.a.createElement(E.a,{latitude:e.location.coordinates[1],longitude:e.location.coordinates[0]},o.a.createElement(L,{icon:e.category,color:"red"})))}),T&&o.a.createElement(E.c,{latitude:T.location.coordinates[1],longitude:T.location.coordinates[0],closeButton:!0,closeOnClick:!1,onClose:function(){P(null)},anchor:"bottom"},o.a.createElement("div",{style:{margin:".5em 0",fontSize:"1em",fontWeight:"500"}},T.name))),c.draftPin&&o.a.createElement("button",{className:"map-marked",onClick:function(){t()}},o.a.createElement(h,null)),J&&!c.liveLocation&&o.a.createElement("button",{className:"map-eye",onClick:function(){l({type:"DELETE_DRAFT"}),l({type:"ADD_LIVE_LOCATION",payload:J}),n()}},o.a.createElement(N,null)),c.liveLocation&&c.liveLocation._id&&o.a.createElement("button",{className:"map-eye",onClick:function(){return Z()}},o.a.createElement(_,null)),o.a.createElement(W.b,{subscription:B,onSubscriptionData:function(e){var t=e.subscriptionData.data.pinAdded;l({type:"CREATE_PIN",payload:t})}}),o.a.createElement(W.b,{subscription:V,onSubscriptionData:function(e){var t=e.subscriptionData.data.liveLocationAdded;l({type:"ADD_LIVELOCATIONS",payload:t})}}),o.a.createElement(W.b,{subscription:F,onSubscriptionData:function(e){var t=e.subscriptionData.data.liveLocationUpdated;l({type:"UPDATE_LIVE_LOCATION",payload:t})}}),o.a.createElement(W.b,{subscription:q,onSubscriptionData:function(e){var t=e.subscriptionData.data.liveLocationDeleted;l({type:"DELETE_LIVE_LOCATIONS",payload:t._id})}}))};var J=function(){var e=Object(a.useContext)(b),t=e.state,n=e.dispatch,r=Object(a.useState)(!1),c=Object(i.a)(r,2),l=c[0],u=c[1],s=Object(a.useState)(!1),p=Object(i.a)(s,2),E=p[0],v=p[1],f=Object(a.useState)(!1),y=Object(i.a)(f,2),g=y[0],L=y[1],O=Object(a.useState)(1),h=Object(i.a)(O,2),N=h[0],_=h[1],j=Object(a.useState)(!1),k=Object(i.a)(j,2),I=k[0],T=(k[1],Object(a.useState)("")),P=Object(i.a)(T,2),R=P[0],$=P[1];console.log(t);var x=function(){var e=Object(m.a)(d.a.mark(function e(){var a,o,r,c,i,l,s,m;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(R){e.next=2;break}return e.abrupt("return");case 2:return a=74*Math.random(),o=Math.round(Number(a)),r=t.draftPin,c=r.lng,i=r.lat,l={name:R,color:o,category:Number(N),type:"Point",lng:c,lat:i},e.next=8,D.request(S,l);case 8:s=e.sent,m=s.createPin,console.log(m),n({type:"DELETE_DRAFT"}),$(""),_(1),u(!1);case 15:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),G=function(){var e=Object(m.a)(d.a.mark(function e(){var a,o,r,c,i,l,u;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(R){e.next=2;break}return e.abrupt("return");case 2:return a=74*Math.random(),Math.round(Number(a)),o=t.liveLocation,r=o.longitude,c=o.latitude,i={name:R,category:Number(N),type:"Point",lng:r,lat:c},e.next=8,D.request(w,i);case 8:l=e.sent,u=l.addLiveLocation,console.log("here",u),n({type:"ADD_LIVE_LOCATION",payload:u}),n({type:"DELETE_DRAFT"}),n({type:"DESELECT_CURRENT_PIN"}),$(""),_(1),L(!1),M(u._id);case 18:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),M=function(e){"geolocation"in navigator&&navigator.geolocation.watchPosition(function(){var t=Object(m.a)(d.a.mark(function t(n){var a,o,r,c;return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a=n.coords,console.log(a),o=a.latitude,r=a.longitude,c={id:e,lng:r,lat:o},t.next=6,D.request(A,c);case 6:t.sent.updateLiveLocation;case 8:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}(),function(e){1===e.code&&v(!0)},{enableHighAccuracy:!0,timeout:5e3,maximumAge:0})},B=function(){return o.a.createElement("div",null,o.a.createElement("input",{name:"name",type:"text",placeholder:"Name",onChange:function(e){return $(e.target.value)},value:R}),o.a.createElement("select",{onChange:function(e){return _(e.target.value)}},o.a.createElement("option",{value:1},"Person"),o.a.createElement("option",{value:2},"Bike"),o.a.createElement("option",{value:3},"Plane"),o.a.createElement("option",{value:4},"Car"),o.a.createElement("option",{value:5},"Bus"),o.a.createElement("option",{value:6},"Home")))};return E?o.a.createElement(C,null,o.a.createElement("div",{className:"modal-content"},o.a.createElement("div",{className:"contents"},o.a.createElement("p",{className:"title"},"Sorry! We're unable to track your Location."),o.a.createElement("p",{className:"desc"},"Note: Everybody will be able to see your shared location!")),o.a.createElement("div",{className:"btn-group"},o.a.createElement("button",{onClick:function(){return v(!1)}},"Cancel")))):o.a.createElement("div",null,l&&o.a.createElement(C,null,o.a.createElement("div",{className:"modal-content"},o.a.createElement("div",{className:"contents"},o.a.createElement("p",{className:"title"},"Would you like to share this location?"),B(),o.a.createElement("p",{className:"desc"},"Note: Everybody will be able to see your shared location!")),o.a.createElement("div",{className:"btn-group"},o.a.createElement("button",{onClick:function(){n({type:"DELETE_DRAFT"}),u(!1)}},"Cancel"),o.a.createElement("button",{onClick:function(){return x()}},"Okay")))),g&&o.a.createElement(C,null,o.a.createElement("div",{className:"modal-content"},o.a.createElement("div",{className:"contents"},o.a.createElement("p",{className:"title"},"Would you like to share your live location?"),B(),o.a.createElement("p",{className:"desc"},"Note: Everybody will be able to see your shared location!")),o.a.createElement("div",{className:"btn-group"},o.a.createElement("button",{onClick:function(){n({type:"DELETE_LIVE_LOCATION"}),L(!1)}},"Cancel"),o.a.createElement("button",{onClick:function(){return G()}},"Okay")))),o.a.createElement(U,{allowLoc:I,modalOpen:function(){return u(!0),void L(!1)},liveLocationModal:function(){return u(!1),void L(!0)}}))},H=n(49);function z(e,t){switch(t.type){case"SET_ICON_AND_COLOR":return Object(p.a)({},e,{pinIcon:t.payload.icon,color:t.payload.color});case"ALL_PINS":return Object(p.a)({},e,{pins:t.payload});case"CREATE_PIN":var n=t.payload,a=e.pins.filter(function(e){return e._id!==n._id});return Object(p.a)({},e,{pins:[].concat(Object(H.a)(a),[n])});case"CREATE_DRAFT":return Object(p.a)({},e,{draftPin:t.payload});case"DELETE_DRAFT":return Object(p.a)({},e,{draftPin:null});case"CURRENT_PIN":return Object(p.a)({},e,{currentPin:t.payload});case"DESELECT_CURRENT_PIN":return Object(p.a)({},e,{currentPin:null});case"ADD_LIVE_LOCATION":return Object(p.a)({},e,{liveLocation:t.payload});case"LIVE_LOCATIONS":return Object(p.a)({},e,{liveLocations:t.payload});case"DELETE_LIVE_LOCATION":return Object(p.a)({},e,{liveLocation:null});case"DELETE_LIVE_LOCATIONS":var o=t.payload,r=e.liveLocations.filter(function(e){return e._id!==o});return Object(p.a)({},e,{liveLocations:r,liveLocation:null,currentPin:null,draftPin:null});case"ADD_LIVELOCATIONS":var c=t.payload,i=e.liveLocations.filter(function(e){return e._id!==c._id});return Object(p.a)({},e,{liveLocations:[].concat(Object(H.a)(i),[c]),currentPin:null,draftPin:null});case"UPDATE_LIVE_LOCATION":var l=t.payload,u=e.liveLocations&&e.liveLocations.length>0&&e.liveLocations.map(function(e){if(e&&e._id)return e._id===l._id?e=l:e});return Object(p.a)({},e,{liveLocations:u});default:return e}}var K=n(29),Y=n(59),Z=n(62),Q=new(n(34).SubscriptionClient)("ws://radiant-lake-34932.herokuapp.com/graphql",{reconnect:!0}),X=new Y.a(Q),ee=new K.a({link:X,cache:new Z.a});var te=function(){var e=Object(a.useContext)(b),t=Object(a.useReducer)(z,e),n=Object(i.a)(t,2),r=n[0],c=n[1];return o.a.createElement(l.a,null,o.a.createElement(W.a,{client:ee},o.a.createElement(b.Provider,{value:{state:r,dispatch:c}},o.a.createElement(u.c,null,o.a.createElement(u.a,{path:"/",component:J})))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(o.a.createElement(te,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[63,1,2]]]);
//# sourceMappingURL=main.94e07607.chunk.js.map